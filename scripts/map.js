!function(){function v(i,l){(i.v||i.yt)&&(i.tooltip='<img class="yt-icon" src="/img/youtube.svg" loading="lazy" alt>'+i.tooltip);var n=null;i.icon&&(t=i.size||40,n={icon:L.icon({iconUrl:"/icons/"+i.icon+".png",iconSize:[t,t],iconAnchor:i.anchor||[t/2,t/2],tooltipAnchor:[t/2,0]})});var e,t,r=[];i.tunnel||i.onewayTunnel?i.coords.forEach(function(e){var t=i.tunnel?"#27b3ff":"#fff";"string"==typeof i.tunnel&&(t=i.tunnel),"string"==typeof i.onewayTunnel&&(t=i.onewayTunnel);var o=L.polyline(e,{weight:8,color:"#000"}).addTo(l);r.push(o);var a=L.polyline(e,{weight:3,color:t}).addTo(l);r.push(a);var n,o={radius:5,weight:2,color:"#000",fillColor:t,fillOpacity:1},a=L.circleMarker(e[0],o).addTo(l);r.push(a),i.tunnel?(n=L.circleMarker(e[e.length-1],o).addTo(l),r.push(n)):(o=e[e.length-1][0]-e[e.length-2][0],n=e[e.length-1][1]-e[e.length-2][1],n=360-57.295779513082*Math.atan2(o,n),t=L.marker(e[e.length-1],{icon:L.divIcon({iconSize:[22,22],iconAnchor:[11,11],html:'<svg width="22" height="22" viewBox="0 0 24 24"><path transform="rotate('+n+' 12 12)" fill='+t+' stroke="#000" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M22 12l-20 12 5-12-5-12z"/></svg>'})}).addTo(l),r.push(t))}):i.cube_path||(i.line?i.coords.forEach(function(e){var t=L.polyline(e,{weight:8,color:"#ffcc7b"}).addTo(l);r.push(t);var o=L.polyline(e,{weight:3,color:"#222"}).addTo(l);r.push(o);var a={radius:5,weight:2,color:"#ffcc7b",fillColor:"#222",fillOpacity:1},n=L.circleMarker(e[0],a).addTo(l);r.push(n);a=L.circleMarker(e[1],a).addTo(l);r.push(a),t.bindTooltip(i.tooltip),o.bindTooltip(i.tooltip)}):i.path?i.coords.forEach(function(e){var t="#149bc7";"string"==typeof i.path&&(t=i.path);var o=L.polyline(e,{weight:8,color:"#000"}).addTo(l);r.push(o);var a=L.polyline(e,{weight:3,color:t}).addTo(l);r.push(a);t=L.marker(e[0],n).addTo(l).bindTooltip(i.tooltip);r.push(t),i.icon2&&(n={icon:L.icon({iconUrl:"/icons/"+i.icon2+".png",iconSize:[40,40],iconAnchor:i.anchor||[20,20],tooltipAnchor:[20,0]})});t=L.marker(e[1],n).addTo(l).bindTooltip(i.tooltip);r.push(t),e[2]&&(e=L.marker(e[2],n).addTo(l).bindTooltip(i.tooltip),r.push(e)),o.bindTooltip(i.tooltip),a.bindTooltip(i.tooltip)}):i.stream?(e=L.polyline(i.coords,{weight:8,color:"#000"}).addTo(l),r.push(e),t=L.polyline(i.coords,{weight:3,color:"#f533dd"}).addTo(l),r.push(t),e.bindTooltip(i.tooltip),t.bindTooltip(i.tooltip)):i.coords&&i.coords.forEach(function(e){var t=i.properties&&i.properties.point_count?i.properties.point_count:0,o=i.size||40,o={cluster:t,radius:20,img:{url:"/icons/"+i.icon+".png",size:[o,o]}};i.offset&&(o.offset=i.offset);o=L.canvasMarker(e,o).addTo(l);t&&o.on("mouseover",function(){if(i.properties&&i.properties.cluster_id){map.hasLayer(g)&&map.removeLayer(g);var e,t=[];for(e of i.clusterIdx.getLeaves(i.properties.cluster_id,1/0))t.push(e.coords||e);g=L.polygon(hull(t,1/0),{color:"#fce51e",interactive:!1}).addTo(map)}}).on("mouseout",function(){map.hasLayer(g)&&map.removeLayer(g)}),r.push(o),o.bindTooltip(i.tooltip),i.popup&&o.bindPopup('<img src="/popups/'+i.popup+'.jpg" width="240" height="240">',{maxWidth:"auto"})})),r.forEach(function(e){var t='<div class="item" onclick="$(\'#'+i.htmlId+' i\').click()"><svg viewBox="0 0 24 24"><path d="M11.885 14.988l3.104-3.098.011.11c0 1.654-1.346 3-3 3l-.115-.012zm8.048-8.032l-3.274 3.268c.212.554.341 1.149.341 1.776 0 2.757-2.243 5-5 5-.631 0-1.229-.13-1.785-.344l-2.377 2.372c1.276.588 2.671.972 4.177.972 7.733 0 11.985-8.449 11.985-8.449s-1.415-2.478-4.067-4.595zm1.431-3.536l-18.619 18.58-1.382-1.422 3.455-3.447c-3.022-2.45-4.818-5.58-4.818-5.58s4.446-7.551 12.015-7.551c1.825 0 3.456.426 4.886 1.075l3.081-3.075 1.382 1.42zm-13.751 10.922l1.519-1.515c-.077-.264-.132-.538-.132-.827 0-1.654 1.346-3 3-3 .291 0 .567.055.833.134l1.518-1.515c-.704-.382-1.496-.619-2.351-.619-2.757 0-5 2.243-5 5 0 .852.235 1.641.613 2.342z"/></svg> '+L10N.Hide+"</div>";i.v?t+='<div class="item" onclick="modal('+i.v+', \'perfect score\')"><svg viewBox="0 0 24 24"><path d="M3 22v-20l18 10-18 10z"/></svg> '+L10N["Play Video"]+"</div>":i.yt&&(t+='<div class="item" onclick="modal(\''+i.yt+'\', \'yt\')"><svg viewBox="0 0 24 24"><path d="M3 22v-20l18 10-18 10z"/></svg> '+L10N["Play Video"]+"</div>"),e.bindPopup(t),c.has("dev")&&e.on("click",function(e){copyToClipboard("["+e.target._latlng.lat+","+e.target._latlng.lng+"],")})})}function w(g,h,u){var f=document.createElement("div");return f.className="subs"+(null===u?" first":""),Object.keys(h).forEach(function(t){var e,o,a,n,i,l,r,c,s,d=(null!==u?u+"-":"")+t,p=g+"-"+(null!==u?u+"-":"")+t,m=h[t];m.until&&Date.parse(m.until)<Date.now()||m.since&&Date.parse(m.since)>Date.now()||((e=document.createElement("div")).id=p,e.className="challenge switch"+(m.toggle?" toggle closed":"")+(k[g][d]?" selected":"")+(m.stage?" stage":""),e.dataset.search=m.name.toLowerCase(),m.toggle&&(e.innerHTML='<div class="arrow"></div>',e.onclick=function(){this.classList.toggle("closed")}),f.appendChild(e),i=document.createElement("span"),(l=document.createElement("i")).onclick=function(e){!function(e,t,o){e.stopPropagation();var a=t.id.indexOf("-"),n=t.id.slice(0,a),i=t.id.slice(a+1);if(o=void 0===o?!t.classList.contains("selected"):o){t.classList.add("selected"),k[n][i]=1,map.addLayer(b[n][i]),t.classList.contains("stage")||t.nextSibling&&$$(".challenge",t.nextSibling).forEach(function(e){e.classList.add("selected"),i=e.id.slice(a+1),k[n][i]=1,map.addLayer(b[n][i])});for(var l=t.parentNode.previousSibling;l&&l.classList.contains("switch");)l.classList.add("selected"),l.id&&(i=l.id.slice(a+1),k[n][i]=1,map.addLayer(b[n][i])),l=l.parentNode.previousSibling}else{t.classList.remove("selected"),delete k[n][i],map.removeLayer(b[n][i]),t.nextSibling&&$$(".challenge",t.nextSibling).forEach(function(e){e.classList.remove("selected"),i=e.id.slice(a+1),delete k[n][i],map.removeLayer(b[n][i])});for(l=t.parentNode.previousSibling;l&&l.classList.contains("switch")&&!l.classList.contains("stage")&&!$(".selected",l.nextSibling);)l.classList.remove("selected"),l.id&&(i=l.id.slice(a+1),delete k[n][i],map.removeLayer(b[n][i])),l=l.parentNode.previousSibling}localStorage.fngg_selected=JSON.stringify(k),D(),logEvents&&ajax("/log",null,"event=map.challenge."+(o?"on":"off")+"."+t.id)}(e,this.parentNode.parentNode)},i.appendChild(l),e.appendChild(i),l=document.createElement("span"),o=m.v||m.markers&&m.markers[0].v,a=m.yt||m.markers&&m.markers[0].yt,n=m.img||m.markers&&m.markers[0].img,(o||a||n)&&((i=document.createElement("img")).className="yt-icon",i.src="/img/youtube.svg",i.loading="lazy",i.alt="",i.onclick=function(){n?modal(n,"img"):o?modal(o,"perfect score"):modal(a,"yt")},l.appendChild(i),e.appendChild(l)),l=document.createElement("span"),m.menu_icon&&((r=document.createElement("img")).src="/icons/"+m.menu_icon+".png?1",r.loading="lazy",r.alt="",l.appendChild(r),e.appendChild(l)),(r=document.createElement("span")).innerHTML=m.name,m.stage&&((l=document.createElement("em")).textContent="Stage "+m.stage,r.prepend(l)),e.appendChild(r),m.until&&((r=document.createElement("div")).className="badge countdown",r.dataset.until=m.until,e.appendChild(r)),m.spawns&&(c=[],m.spawns.forEach(function(e){c=c.concat(window.Data.data.spawns.sub[e].markers)}),(m.v||m.yt)&&c.forEach(function(e){m.v&&(e.v=m.v),m.yt&&(e.yt=m.yt)}),m.markers?m.markers=m.markers.concat(c):m.markers=c),s=L.layerGroup(),m.markers&&(m.cluster&&m.markers.forEach(function(e){var t=L.layerGroup().addTo(s),o=5;if(e.coords[0]&&3===e.coords[0].length){for(var o=16,a=[],n=0;n<e.coords.length;n++)for(var i=0;i<e.coords[n][0];i++)a.push([e.coords[n][1],e.coords[n][2]]);e.coords=a}y.push(new Supercluster({layerGroup:t,icon:e.icon,htmlId:p,tooltip:m.name,radius:50,extent:256,maxZoom:o}).load(e.coords))}),"poi"===t||"landmarks"===t?m.markers.forEach(function(e){L.canvasMarker(e.coords,{text:e.name,color:"#fff",stroke:"landmarks"===t?"#5756dc":"#000",radius:100,interactive:!1}).addTo(s)}):m.cluster||m.markers.forEach(function(e){e.tooltip=m.name,e.htmlId=p,v(e,s)})),b[g][d]=s,k[g][d]&&map.addLayer(s),m.sub&&f.appendChild(w(g,m.sub,d)))}),f}function e(){var r=document.createElement("div");r.className="data-wrap";var e=document.createElement("div");e.style.position="relative";var t=document.createElement("img");t.className="search-clear",t.src="/img/search-clear.svg",t.onclick=function(){o.value="",$$(".switch").forEach(function(e){e.style.display=""}),$(".data-wrap").classList.remove("searching")},e.appendChild(t);var o=document.createElement("input");o.className="input",o.placeholder=L10N.Search+"...",o.autocomplete="off",o.style.marginBottom="26px",o.addEventListener("input",function(e){var t=e.target.value.trim().toLowerCase();t.length?($$(".switch").forEach(function(e){~e.dataset.search.indexOf(t)?e.style.display="block":e.style.display="none"}),$(".data-wrap").classList.add("searching")):($$(".switch").forEach(function(e){e.style.display=""}),$(".data-wrap").classList.remove("searching"))}),e.appendChild(o),r.appendChild(e),Object.keys(window.Data.data).forEach(function(a){b[a]={},k[a]=k[a]||{};var e,t,o,n,i,l=window.Data.data[a];l.sub&&(l.until&&Date.parse(l.until)<Date.now()||((e=document.createElement("div")).className="week-wrap"+(u[a]?" opened":""),(t=document.createElement("div")).className="week switch"+(k[a]&&Object.keys(k[a]).length?" selected":""),t.dataset.search=l.name.toLowerCase(),t.innerHTML='<div class="arrow"></div>',t.onclick=function(){var e,t,o;e=this.parentNode,t=a,o="open",e.classList.contains("opened")?(o="close",e.classList.remove("opened"),delete u[t]):(e.classList.add("opened"),u[t]=1),localStorage.fngg_opened=JSON.stringify(u),logEvents&&ajax("/log",null,"event=map.week."+o+"."+t)},n=document.createElement("span"),(o=document.createElement("i")).onclick=function(e){!function(e,t,o){e.stopPropagation();var a,e="on";t.classList.contains("selected")?(e="off",t.classList.remove("selected"),k[o]={},Object.values(b[o]).forEach(function(e){map.removeLayer(e)}),$$(".challenge",t.parentNode).forEach(function(e){e.classList.remove("selected")})):(t.classList.add("selected"),k[o]={},Object.values(b[o]).forEach(function(e){map.addLayer(e)}),a=o.length,$$(".challenge",t.parentNode).forEach(function(e){e.classList.add("selected");e=e.id.slice(a+1);k[o][e]=1})),localStorage.fngg_selected=JSON.stringify(k),D(),logEvents&&ajax("/log",null,"event=map.week."+e+"."+o)}(e,this.parentNode.parentNode,a)},n.appendChild(o),t.appendChild(n),o=document.createElement("span"),n=l.edited&&Date.parse(l.edited)>localStorage.lastSeen,l.menu_icon?o.innerHTML='<span><img src="/icons/'+l.menu_icon+'.png" loading="lazy" alt></span><span'+(l.color?' style="border-bottom: 2px solid '+l.color+'"':"")+">"+l.name+"</span>":o.innerHTML=l.name,t.appendChild(o),n&&((i=document.createElement("div")).className="badge new",i.textContent="New",t.appendChild(i)),l.until&&((i=document.createElement("div")).className="badge countdown",i.dataset.until=l.until,t.appendChild(i)),l.badge&&((i=document.createElement("div")).className="badge new",i.innerHTML=l.badge,t.appendChild(i)),e.appendChild(t),e.appendChild(w(a,l.sub,null)),r.appendChild(e)))}),$("#sidebar-top").appendChild(r)}function n(e,t){e>window.innerWidth-60&&(e=window.innerWidth-60),p.style.left=m.style.left=d.style.width=e+"px",t&&(a.style.left=e+"px")}function t(e){i=!0;var a=(e.pageX||e.changedTouches[0].pageX)-l;document.addEventListener("mousemove",function(e){i&&n(l=(l=e.pageX-a)>window.innerWidth-60?window.innerWidth-60:l)}),document.addEventListener("touchmove",function(e){var t=e.changedTouches;if(i)for(var o=0;o<t.length;o++)n(l=(l=t[o].pageX-a)>window.innerWidth-60?window.innerWidth-60:l)})}function o(){i&&(i=!1,localStorage.resize=l,a.style.left=l+"px",map.invalidateSize())}function r(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}logEvents=!1;var c=new URLSearchParams(location.search),i=!1,l=localStorage.resize||360,s=!1,a=$("#map"),d=($("#message"),$("#sidebar")),p=$("#resize-sidebar"),m=$("#toggle-sidebar"),y=[],g=null,h=document.createElement("div");h.className="sidebar-right",L.Browser.mobile&&document.body.classList.add("mobile"),localStorage.resize?n(localStorage.resize,!0):0<window.innerWidth&&window.innerWidth<390&&n(window.innerWidth,!0),localStorage.hideSidebar?(document.body.classList.add("big"),setTooltip(m,L10N["Open sidebar"])):setTooltip(m,L10N["Close sidebar"]),localStorage.removeItem("selected"),localStorage.removeItem("opened"),localStorage.removeItem("season"),localStorage.removeItem("completedPunchcards"),localStorage.removeItem("completedAchievements");var b={},k={},u={};window.Selected?k=window.Selected:localStorage.fngg_selected&&(k=JSON.parse(localStorage.fngg_selected)),localStorage.fngg_opened&&(u=JSON.parse(localStorage.fngg_opened)),localStorage.fngg_season!=window.Data.season&&(localStorage.fngg_season=window.Data.season,k={poi:k.poi,spawns:k.spawns},u={poi:u.poi,spawns:u.spawns},localStorage.fngg_selected=JSON.stringify(k),localStorage.fngg_opened=JSON.stringify(u)),localStorage.fngg_new_poi||(localStorage.fngg_new_poi=1,k.poi=k.poi||{},k.poi.poi=1,localStorage.fngg_selected=JSON.stringify(k)),map=L.map(a,{crs:L.CRS.Simple,center:[-128,128],zoom:1,minZoom:0,maxZoom:7,zoomSnap:0,zoomControl:!1,attributionControl:!1,tap:!1,preferCanvas:!0,renderer:L.canvas({padding:L.Browser.mobile?0:.5})}),L.Browser.mobile||L.control.zoom({position:"bottomright"}).addTo(map);var f=[[-256,0],[0,256]];map.fitBounds(f,{animate:!1});var E,S,T,C,M,N,z,x=L.tileLayer("https://fortnite.gg/maps/"+Data.map+"/{z}/{x}/{y}.jpg",{noWrap:!0,bounds:f}).addTo(map);window.addEventListener("load",function(){$("img",x.getContainer()).style.width||x.redraw()});{function D(){y.forEach(function(t){var o=t.getClusters(map);o&&(o.layerGroup.clearLayers(),o.markers.forEach(function(e){e.clusterIdx=t,e.icon=o.icon,e.tooltip=o.tooltip,e.htmlId=o.htmlId,e.coords=[e.coords],v(e,o.layerGroup)}))})}function _(e){var t=e._leaflet_id;S[t]||(S[t]=L.layerGroup().addTo(map)),S[t].clearLayers();for(var o=e._latlngs,a=0;a+1<o.length;a++){var n=o[a+1].lat-o[a].lat,i=o[a+1].lng-o[a].lng,l=[o[a].lat+n/2,o[a].lng+i/2],i=360-57.295779513082*Math.atan2(n,i);new L.marker(l,{icon:new L.divIcon({className:"arrowIcon",iconSize:[22,22],iconAnchor:[11,11],html:'<svg width="22" height="22" viewBox="0 0 24 24"><path transform="rotate('+i+' 12 12)" fill="#fff" stroke="#000" d="M14 2h-7.229l7.014 7h-13.785v6h13.785l-7.014 7h7.229l10-10z"/></svg>'})}).addTo(S[t]).options={drawtype:"arrow",angle:i},S[t].options={drawtype:"arrows"}}}function I(e){e=e._leaflet_id;S[e]&&S[e].clearLayers()}function O(e){if(!T)return e;var t=.8752;return e[0].map?e.map(e=>[e[0]*t-16,e[1]*t+16]):[e[0]*t-16,e[1]*t+16]}function B(i,l,e){l.options.drawtype=i,E.addLayer(l),l.on("click",function(e){var t=document.createElement("div"),o=document.createElement("div");o.className="item",o.innerHTML='<svg width="14" height="14" viewBox="0 0 24 24"><path d="M7.127 22.562l-7.127 1.438 1.438-7.128 5.689 5.69zm1.414-1.414l11.228-11.225-5.69-5.692-11.227 11.227 5.689 5.69zm9.768-21.148l-2.816 2.817 5.691 5.691 2.816-2.819-5.691-5.689z"/></svg> '+L10N.Edit,o.onclick=function(){map.closePopup(n),l.editing.enable(),"polyline"===i&&I(l),map.on("click",function(){"polyline"===i&&_(l),l.editing.disable()})},t.appendChild(o);o=document.createElement("div");o.className="item",o.innerHTML='<svg width="14" height="14" viewBox="0 0 24 24"><path d="M3 6l3 18h12l3-18h-18zm19-4v2h-20v-2h5.711c.9 0 1.631-1.099 1.631-2h5.316c0 .901.73 2 1.631 2h5.711z"/></svg> '+L10N.Delete,o.onclick=function(){map.closePopup(n),"polyline"===i&&I(l),E.removeLayer(l)},t.appendChild(o);o=document.createElement("div");o.className="item",o.innerHTML='<svg width="14" height="14" viewBox="0 0 24 24"><path d="M12 22c0 1.105-.896 2-2 2s-2-.895-2-2 .896-2 2-2 2 .895 2 2zm-12-8c0 1.104.895 2 2 2s2-.896 2-2-.895-2-2-2-2 .896-2 2zm4 4c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm0-12c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm12 12c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-.244-8.679l1.034 1.023-5.52 5.469c-1.017 1.005-1.626.132-2.941 1.023-.177.118-.362.164-.538.155-.437-.027-.806-.406-.776-.886.006-.159.064-.328.171-.499.79-1.257.021-1.914 1.013-2.892l5.491-5.439 1.031 1.024-2.915 2.879 2.188-.128 1.762-1.729zm1.025-5.293c-.036.849-.333 1.218-.719 1.195-.215-.014-.425-.149-.618-.32-.279-.247-.705-.23-.973.036-.289.293-.283.768.01 1.055l3.609 3.569c.292.287.761.286 1.047-.006.265-.27.276-.697.025-.979-.191-.212-.34-.443-.324-.684.021-.35.393-.616 1.185-.659 2.664-.146 3.977-1.699 3.977-3.545 0-2.124-1.666-3.69-3.688-3.69-1.869 0-3.416 1.32-3.531 4.028z"/></svg> '+L10N["Change color"],o.onclick=function(){var e=document.createElement("div");new Picker({parent:e,color:l.options.color||"#fce51e",popup:!1,onChange:function(e){"circlemarker"===i?l._icon.firstChild.style.color=e.rgbaString:l._icon?l._icon.firstChild.style.fill=e.rgbaString:l.setStyle({color:e.rgbaString}),l.options.color=e.rgbaString}}),n.setContent(e)},t.appendChild(o),"marker"!==i&&"circlemarker"!==i||((a=document.createElement("div")).className="item",a.innerHTML='<svg width="14" height="14" viewBox="0 0 24 24"><path d="M22 0h-20v6h1.999c0-1.174.397-3 2.001-3h4v16.874c0 1.174-.825 2.126-2 2.126h-1v2h9.999v-2h-.999c-1.174 0-2-.952-2-2.126v-16.874h4c1.649 0 2.02 1.826 2.02 3h1.98v-6z"/></svg> Change text',a.onclick=function(){var e=prompt("Enter text: ");e&&("marker"===i?l.bindTooltip(r(e)):"circlemarker"===i&&l.setIcon(new L.divIcon({className:"marker-text",html:"<div"+(l.options.color?' style="color:'+l.options.color+'"':"")+">"+r(e)+"</div>",iconSize:null})),l.options.tooltip=e),map.closePopup(n)},t.appendChild(a));var a={};"marker"===i&&(a={offset:[0,-25]});var n=L.popup(a).setLatLng(e.latlng).setContent(t).openOn(map)}),"polyline"===i&&_(l),"marker"===i&&e&&((e=prompt("Enter marker text: "))&&(l.bindTooltip(r(e)),l.options.tooltip=e),l._icon.classList.remove("crosshair"))}~location.search.indexOf("map=")||(e(),D(),map.on("zoomend",D),"/embed"!==location.pathname&&(E=new L.FeatureGroup,map.addLayer(E),S={},window.Drawing&&(f=[[0,256],[-256,0]],Object.keys(Drawing).forEach(function(t){Drawing[t].forEach&&Drawing[t].forEach(function(e){e.color||(e.color="#fce51e"),"circle"===t||"marker"===t||"circlemarker"===t?f=[[Math.min(f[0][0],e.latlng[0]),Math.min(f[0][1],e.latlng[1])],[Math.max(f[1][0],e.latlng[0]),Math.max(f[1][1],e.latlng[1])]]:e.latlng.forEach(function(e){f=[[Math.min(f[0][0],e[0]),Math.min(f[0][1],e[1])],[Math.max(f[1][0],e[0]),Math.max(f[1][1],e[1])]]})})}),map.fitBounds(f),T=!1,(C=c.get("d"))&&4===(C=C.split("/")).length&&new Date(String(2e3+Number(C[0]))+"-"+C[1].padStart(2,"0")+"-"+C[2].padStart(2,"0"))<new Date("2023-03-10")&&(T=!0),Drawing.polyline&&Drawing.polyline.forEach(function(e){B("polyline",L.polyline(O(e.latlng),{color:e.color,weight:4}),!1)}),Drawing.polygon&&Drawing.polygon.forEach(function(e){B("polygon",L.polygon(O(e.latlng),{color:e.color,fillOpacity:.4,weight:4}),!1)}),Drawing.rectangle&&Drawing.rectangle.forEach(function(e){B("rectangle",L.rectangle(O(e.latlng),{color:e.color,fillOpacity:.4,weight:4}),!1)}),Drawing.circle&&Drawing.circle.forEach(function(e){B("circle",L.circle(O(e.latlng),{radius:e.radius,color:e.color,fillOpacity:.4,weight:4}),!1)}),Drawing.marker&&Drawing.marker.forEach(function(e){var t,o,a=L.marker(O(e.latlng),{color:e.color,icon:new L.divIcon({iconSize:[30,30],iconAnchor:[15,30],tooltipAnchor:[15,-15],html:'<svg width="30" height="30" viewBox="0 0 24 24" style="fill:'+e.color+';stroke:#000"><path d="M12 0c-4.198 0-8 3.403-8 7.602 0 4.198 3.469 9.21 8 16.398 4.531-7.188 8-12.2 8-16.398 0-4.199-3.801-7.602-8-7.602zm0 11c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z"/></svg>'})});e.tooltip&&(a.options.tooltip=e.tooltip,t=r(e.tooltip),a.bindTooltip(t),s=!0,(o=document.createElement("div")).innerHTML='<svg viewBox="0 0 24 24" width="20" height="20" style="fill:'+e.color+';stroke:#000"><path d="M12 0c-4.198 0-8 3.403-8 7.602 0 4.198 3.469 9.21 8 16.398 4.531-7.188 8-12.2 8-16.398 0-4.199-3.801-7.602-8-7.602zm0 11c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z"></path></svg>'+t,o.onmouseover=function(){a._icon.classList.add("marker-hover")},o.onmouseout=function(){a._icon.classList.remove("marker-hover")},o.onclick=function(){map.setView(a._latlng,6)},h.appendChild(o)),B("marker",a,!1)}),Drawing.circlemarker&&Drawing.circlemarker.forEach(function(e){var t;e.tooltip&&((t=L.marker(O(e.latlng),{color:e.color,icon:L.divIcon({className:"marker-text",html:'<div style="color:'+e.color+'">'+r(e.tooltip)+"</div>",iconSize:null})})).options.tooltip=e.tooltip,B("circlemarker",t,!1))}),s&&!L.Browser.mobile&&(a.style.right="190px",document.body.appendChild(h),(z=document.createElement("div")).className="leaflet-bar leaflet-control",z.style.marginBottom="20px",z.dataset.tooltipRight=!0,setTooltip(z,"Close"),z.innerHTML='<a class="close-sidebar-right" href="#"><svg width="18" height="18" viewBox="0 0 24 24"><path d="M16.67 0l2.83 2.829-9.339 9.175 9.339 9.167-2.83 2.829-12.17-11.996z"></path></svg></a>',z.onclick=function(e){e.preventDefault(),this.style.display="none",h.style.display="none",a.style.right="0"},(N=$(".leaflet-top.leaflet-right")).insertBefore(z,N.firstChild))),z=L.Control.extend({options:{position:"topright"},onAdd:function(t){var e=document.createElement("div");e.className="leaflet-bar leaflet-control",e.onclick=function(e){e.preventDefault(),t.addControl(new L.Control.Draw({edit:!1})),t.addControl(new M),this.style.display="none"};var o=document.createElement("a");return o.className="leaflet-draw-open",o.href="#",o.innerHTML='<svg width="14" height="14" viewBox="0 0 24 24"><path d="M7.127 22.562l-7.127 1.438 1.438-7.128 5.689 5.69zm1.414-1.414l11.228-11.225-5.69-5.692-11.227 11.227 5.689 5.69zm9.768-21.148l-2.816 2.817 5.691 5.691 2.816-2.819-5.691-5.689z"/></svg>',e.appendChild(o),o.setAttribute("data-tooltip-right",""),o.setAttribute("aria-label",L10N["Draw on map"]),setTooltip(o,L10N["Draw on map"]),e}}),M=L.Control.extend({options:{position:"topright"},onAdd:function(e){function t(e){drawLayersExport={polyline:[],polygon:[],rectangle:[],circle:[],marker:[],circlemarker:[]},E.eachLayer(function(e){var t,o={color:e.options.color},a=e.options.drawtype;"circle"===a?(o.radius=Math.round(100*e.getRadius())/100,o.latlng=[Math.round(100*e._latlng.lat)/100,Math.round(100*e._latlng.lng)/100]):"marker"===a||"circlemarker"===a?(o.latlng=[Math.round(100*e._latlng.lat)/100,Math.round(100*e._latlng.lng)/100],e.options.tooltip&&(o.tooltip=e.options.tooltip)):"polyline"!==a&&"polygon"!==a&&"rectangle"!==a||(t=[],("polyline"===a?e._latlngs:e._latlngs[0]).forEach(function(e){t.push([Math.round(100*e.lat)/100,Math.round(100*e.lng)/100])}),o.latlng=t),drawLayersExport[a].push(o)});for(var t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",o=t.length,a="",n=0;n<8;n++)a+=t.charAt(Math.floor(Math.random()*o));var i=new Date,i=i.getFullYear().toString().slice(2)+"/"+(i.getMonth()+1)+"/"+i.getDate();e=e?i+"/"+a:getUrlParameter("d"),c.set("d",e);var l=[];c.forEach((e,t)=>l.push(t+(e?"="+e:"")));i=l.join("&").replace(/%2F/g,"/");copyToClipboard(location.origin+location.pathname+"?"+i),history.replaceState(null,null,location.origin+location.pathname+"?"+i);var r=new XMLHttpRequest;r.open("POST","/save-draw?d="+e,!0),r.onload=function(){200===r.status&&"ok"!==r.responseText&&showMessage(L10N["Connection error, please try again later."],"error")},r.setRequestHeader("Content-Type","application/json"),r.send(JSON.stringify(drawLayersExport))}var o=document.createElement("div");o.className="leaflet-bar leaflet-control",o.style.textAlign="right";var a='<svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M15.003 3h2.997v5h-2.997v-5zm8.997 1v20h-24v-24h20l4 4zm-19 5h14v-7h-14v7zm16 4h-18v9h18v-9z"/></svg>',n=document.createElement("a");n.className="leaflet-draw-save",n.href="#",n.innerHTML=a+" <span>Save"+(window.IsLogged?"":" (Sign In)")+"</span>",window.Drawing||(n.style.display="none"),window.IsMy&&window.IsLogged||(n.style.opacity=.5,n.style.pointerEvents="none"),n.onclick=function(e){e.preventDefault(),t(!1)};var i=document.createElement("a");return i.className="leaflet-draw-save",i.href="#",i.innerHTML=a+" <span>"+(window.Drawing?"New ":"")+"Save</span>",i.onclick=function(e){e.preventDefault(),t(!0),$("span",i).textContent="New Save",n.style.display="",window.IsLogged&&(n.style.opacity=1,n.style.pointerEvents="auto")},o.append(n,document.createElement("br"),i),o}}),map.on("draw:created",function(e){B(e.layerType,e.layer,!0)}),map.addControl(new z)))}$$(".countdown").forEach(function(n){function e(){var e=i-Date.now(),t=(Math.floor(e/1e3%60),Math.floor(e/1e3/60%60)),o=Math.floor(e/36e5%24),a=Math.floor(e/864e5);e<6e4?n.parentElement.parentElement.style.display="none":(e="⏱️ ",0<a&&(e+=a+"d "),0<o&&(e+=o+"h "),0<t&&(e+=t+"m "),n.innerHTML=e)}var i=Date.parse(n.dataset.until);e(),setInterval(e,6e4)}),p.addEventListener("mousedown",t),p.addEventListener("touchstart",t),document.addEventListener("mouseup",o),document.addEventListener("touchend",o),m.addEventListener("click",function(){document.body.classList.contains("big")?(document.body.classList.remove("big"),localStorage.removeItem("hideSidebar"),setTooltip(this,L10N["Close sidebar"])):(document.body.classList.add("big"),localStorage.hideSidebar=1,setTooltip(this,L10N["Open sidebar"])),map.invalidateSize()}),on("#open-filters","click",function(){document.body.classList.add("filters-opened")}),on("#close-filters","click",function(){document.body.classList.remove("filters-opened")}),c.has("dev")&&($(".leaflet-container").style.cursor="default",map.on("click",function(e){copyToClipboard("["+Math.round(100*e.latlng.lat)/100+","+Math.round(100*e.latlng.lng)/100+"],")})),localStorage.lastSeen=Date.now(),"?xy"===location.search&&(N=prompt("X: "),N=parseFloat(N)||0,z=prompt("Y: "),z=parseFloat(z)||0,[N,z]=[-z,N],z=[256*-(1-(N+15e4+500)/3e5),(z+15e4+-8550)/3e5*256],L.marker(z,{icon:new L.divIcon({iconSize:[30,30],iconAnchor:[15,30],tooltipAnchor:[15,-15],html:'<svg width="30" height="30" viewBox="0 0 24 24" style="fill:#fce51e;stroke:#000"><path d="M12 0c-4.198 0-8 3.403-8 7.602 0 4.198 3.469 9.21 8 16.398 4.531-7.188 8-12.2 8-16.398 0-4.199-3.801-7.602-8-7.602zm0 11c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z"/></svg>'})}).addTo(map),map.setView(z,6)),$(".menu-tos").style.display="block"}();